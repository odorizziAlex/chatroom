{"ast":null,"code":"var _jsxFileName = \"/Users/alexodorizzi/Desktop/Projects/ChatRoom/chatroom/src/components/MainContentArea.js\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport styled from \"styled-components\";\nimport axios from \"axios\";\nimport Chat from \"./Chat/Chat\";\nimport { v4 as uuidv4 } from 'uuid';\nimport { UserContext } from \"../contexts/UserContext\";\nimport { CookieManager } from \"../cookies/CookieManager\";\nimport { Config } from \"../config/Config\";\nimport io from \"socket.io-client\";\nconst ENDPOINT = \"http://127.0.0.1:5000\"; // import { Manager } from \"socket.io-client\";\n// const manager = new Manager(\"ws://localhost:5000\", {\n//     reconnectionDelayMax: 1000,\n// })\n// const socket = manager.socket(\"/\",{\n//     query: {\n//         auth:\"123\",\n//     }\n// })\n\nconst MainContentArea = () => {\n  const [example, setExample] = useState('');\n  const socket = io(ENDPOINT); // useEffect(()=>{\n  //     const socket = io(ENDPOINT, {transports: ['polling']});\n  //     socket.on(\"changes\", data => {\n  //         console.log(\"changes\");\n  //         setExample(data);\n  //     });\n  // }, []);\n\n  useEffect(() => {\n    socket.on(\"new-user-joined\", data => {\n      console.log(\"Got changes: \", data);\n    });\n  }, []);\n  const {\n    config\n  } = useContext(Config);\n  const {\n    users,\n    addUserToDB,\n    getUserByName,\n    deleteUser\n  } = useContext(UserContext);\n  const {\n    setUserCreatedCookie,\n    getCookieByKey,\n    deleteCookieByKey\n  } = useContext(CookieManager);\n  const [newUserName, setNewUserName] = useState(\"\");\n  const [currentUser, setCurrentUser] = useState(undefined);\n  const [isShowPopup, setIsShowPopup] = useState(true);\n  const [usernameIsTooShort, setUsernameIsTooShort] = useState(false);\n  useEffect(() => {\n    console.log(\"mount\");\n\n    if (getCookieByKey(config.cookieUserKey) !== undefined) {\n      console.log(\"current User name:\", getCookieByKey(config.cookieUserKey)); // save cookie on reload or leaving the page for about 1h\n      // when user comes back in time load user from cookie again and delete cookie\n      // when user doesn't come back in time, delete cookie and user.\n    } else if (!isShowPopup) {\n      let currUsr = getUserByName(newUserName);\n      setCurrentUser(currUsr);\n      setUserCreatedCookie(currUsr);\n      socket.emmit(\"new-chat-user\", currUsr);\n    }\n  }, [users, example]);\n  window.addEventListener(\"beforeunload\", () => {\n    if (currentUser !== undefined) {\n      deleteCookieByKey(currentUser.username);\n      deleteUser(currentUser);\n    }\n  });\n\n  const handleUserNameInputChange = e => {\n    setNewUserName(e.target.value);\n  };\n\n  const onUserNameSubmit = e => {\n    e.preventDefault();\n\n    if (newUserName.length < 3) {\n      setUsernameIsTooShort(true);\n    } else {\n      let newUsr = {\n        customId: uuidv4(),\n        username: newUserName\n      };\n      addUserToDB(newUsr);\n      setIsShowPopup(false);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(StyledArea, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 9\n    }\n  }, isShowPopup && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Overlay, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Popup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(PopupDescription, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 25\n    }\n  }, \"The User you're about to create will only exist as long as you stay on this page. If you leave, or reload the page your user will be deleted.\"), /*#__PURE__*/React.createElement(FormWrapper, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(StyledInput, {\n    type: \"text\",\n    value: newUserName,\n    onChange: handleUserNameInputChange,\n    placeholder: \"Pick a Username...\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 25\n    }\n  }), newUserName !== \"\" && /*#__PURE__*/React.createElement(StyledButton, {\n    onClick: onUserNameSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 25\n    }\n  }, \"Create User.\")), usernameIsTooShort && /*#__PURE__*/React.createElement(Warning, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 25\n    }\n  }, \"The Username has to have at least 3 characters.\"))), /*#__PURE__*/React.createElement(Chat, {\n    data: example,\n    user: currentUser,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 13\n    }\n  }));\n};\n\nexport default MainContentArea;\nconst Overlay = styled.div`\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.5);\n    z-index: 2;\n`;\nconst Popup = styled.div`\n// display: flex;\n    align-items: center;\n    justify-content: center;\n    position: fixed;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    padding: 20px;\n    background: var(--dark-grey);\n    border-radius: 10px;\n    float: left;\n    box-sizing: border-box;\n    border: 2px var(--dark-grey);\n    transition: all 0.2s;\n    z-index: 3;\n`;\nconst PopupDescription = styled.div`\n    font-size: 13px;\n    text-align: center;\n    color: var(--black);\n    padding-bottom: 20px;\n    font-weight: bold;\n`;\nconst StyledButton = styled.button`\n    display: flex;\n    text-decoration: none;\n    justify-content: center;\n    padding: 10px 20px;\n    background: var(--light-grey);\n    color: var(--dark-grey);\n    font-weight: 600;\n    font-size: 1rem;\n    border: 0;\n    border-radius: 6px;\n    // margin-top: 10px;\n    // margin-right: 10px;\n    cursor: pointer;\n\n    &:focus {\n        outline: none;\n    }\n`;\nconst FormWrapper = styled.form`\n    display: flex;\n`;\nconst StyledInput = styled.input`\n    border: 0;\n    border-radius: 6px;\n    display: block;\n    width: 100%;\n    padding: 20px;\n    // font-size: 15px;\n    font-size: 1rem;\n    margin-right: 4px;\n    color: var(--black);\n    background: var(--light-grey);\n`;\nconst StyledArea = styled.div`\n    display: grid;\n    // grid-template-columns: 1fr 1fr;\n    padding: 20px;\n    background: var(--app-background);\n    overflow: auto;\n    height: 100vh;\n`;\nconst Warning = styled.div`\n    font-size: 13px;\n    color: var(--warning);\n    text-align: center;\n    font-weight: bold;\n    padding-top: 20px;\n`;","map":{"version":3,"sources":["/Users/alexodorizzi/Desktop/Projects/ChatRoom/chatroom/src/components/MainContentArea.js"],"names":["React","useContext","useEffect","useState","styled","axios","Chat","v4","uuidv4","UserContext","CookieManager","Config","io","ENDPOINT","MainContentArea","example","setExample","socket","on","data","console","log","config","users","addUserToDB","getUserByName","deleteUser","setUserCreatedCookie","getCookieByKey","deleteCookieByKey","newUserName","setNewUserName","currentUser","setCurrentUser","undefined","isShowPopup","setIsShowPopup","usernameIsTooShort","setUsernameIsTooShort","cookieUserKey","currUsr","emmit","window","addEventListener","username","handleUserNameInputChange","e","target","value","onUserNameSubmit","preventDefault","length","newUsr","customId","Overlay","div","Popup","PopupDescription","StyledButton","button","FormWrapper","form","StyledInput","input","StyledArea","Warning"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport styled from \"styled-components\";\nimport axios from \"axios\";\nimport Chat from \"./Chat/Chat\";\nimport { v4 as uuidv4 } from 'uuid';\nimport { UserContext } from \"../contexts/UserContext\";\nimport { CookieManager } from \"../cookies/CookieManager\";\nimport { Config } from \"../config/Config\";\n\nimport io from \"socket.io-client\";\nconst ENDPOINT = \"http://127.0.0.1:5000\";\n\n// import { Manager } from \"socket.io-client\";\n\n// const manager = new Manager(\"ws://localhost:5000\", {\n//     reconnectionDelayMax: 1000,\n// })\n\n// const socket = manager.socket(\"/\",{\n//     query: {\n//         auth:\"123\",\n//     }\n// })\n\n\nconst MainContentArea = () => {\n    const [example, setExample] = useState('');\n    const socket = io(ENDPOINT);\n\n    \n    \n    // useEffect(()=>{\n    //     const socket = io(ENDPOINT, {transports: ['polling']});\n    //     socket.on(\"changes\", data => {\n    //         console.log(\"changes\");\n    //         setExample(data);\n    //     });\n    // }, []);\n\n    useEffect(() => {\n        \n        socket.on(\"new-user-joined\", data => {\n            console.log(\"Got changes: \", data);\n        })\n    }, []);\n \n    const { config } = useContext(Config);\n    const {users, addUserToDB, getUserByName, deleteUser} = useContext(UserContext);\n    const { setUserCreatedCookie, getCookieByKey, deleteCookieByKey } = useContext(CookieManager);\n    const [newUserName, setNewUserName] = useState(\"\");\n    const [currentUser, setCurrentUser] = useState(undefined);\n    const [isShowPopup, setIsShowPopup] = useState(true);\n    const [usernameIsTooShort, setUsernameIsTooShort] = useState(false);\n    \n \n\n    useEffect(() => {\n        console.log(\"mount\");\n        if(getCookieByKey(config.cookieUserKey) !== undefined){\n            console.log(\"current User name:\",getCookieByKey(config.cookieUserKey));\n            // save cookie on reload or leaving the page for about 1h\n            // when user comes back in time load user from cookie again and delete cookie\n            // when user doesn't come back in time, delete cookie and user.\n\n        }else if(!isShowPopup){\n            let currUsr = getUserByName(newUserName);\n            setCurrentUser(currUsr);\n            setUserCreatedCookie(currUsr);\n            socket.emmit(\"new-chat-user\", currUsr);\n\n\n        }\n    },[users,example]);\n\n    window.addEventListener(\"beforeunload\", () => {\n        if(currentUser !== undefined){\n            deleteCookieByKey(currentUser.username);\n            deleteUser(currentUser);\n        }\n    });\n\n    const handleUserNameInputChange = (e) => {\n        setNewUserName(e.target.value);\n    }\n    \n    const onUserNameSubmit = (e) => {\n        e.preventDefault();\n        if(newUserName.length < 3){\n            setUsernameIsTooShort(true);\n        }else{\n            let newUsr = {\n                customId:uuidv4(),\n                username:newUserName,\n            }\n            addUserToDB(newUsr);\n            setIsShowPopup(false);\n        }\n    }\n\n    return (\n        <StyledArea>\n            {isShowPopup && \n            <>\n                <Overlay/>\n                <Popup>\n                        <PopupDescription>\n                            The User you're about to create will only exist as long as you stay on this page.\n                            If you leave, or reload the page your user will be deleted.\n                        </PopupDescription>\n                    <FormWrapper>\n                        <StyledInput\n                            type=\"text\"\n                            value={newUserName}\n                            onChange={handleUserNameInputChange}\n                            placeholder=\"Pick a Username...\"\n                        />\n\n                        {newUserName !== \"\" && \n                        <StyledButton \n                            onClick={onUserNameSubmit}\n                        >\n                            Create User.\n                        </StyledButton>}\n                    </FormWrapper>\n                    {usernameIsTooShort && \n                        <Warning>The Username has to have at least 3 characters.</Warning>\n                    }\n                </Popup>\n            </>\n            }\n            <Chat data={example} user = {currentUser}/>\n        </StyledArea>\n    );\n}\n\nexport default MainContentArea;\n\nconst Overlay = styled.div`\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.5);\n    z-index: 2;\n`;\n\nconst Popup = styled.div`\n// display: flex;\n    align-items: center;\n    justify-content: center;\n    position: fixed;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    padding: 20px;\n    background: var(--dark-grey);\n    border-radius: 10px;\n    float: left;\n    box-sizing: border-box;\n    border: 2px var(--dark-grey);\n    transition: all 0.2s;\n    z-index: 3;\n`;\n\nconst PopupDescription = styled.div`\n    font-size: 13px;\n    text-align: center;\n    color: var(--black);\n    padding-bottom: 20px;\n    font-weight: bold;\n`;\n\nconst StyledButton = styled.button`\n    display: flex;\n    text-decoration: none;\n    justify-content: center;\n    padding: 10px 20px;\n    background: var(--light-grey);\n    color: var(--dark-grey);\n    font-weight: 600;\n    font-size: 1rem;\n    border: 0;\n    border-radius: 6px;\n    // margin-top: 10px;\n    // margin-right: 10px;\n    cursor: pointer;\n\n    &:focus {\n        outline: none;\n    }\n`;\n\nconst FormWrapper = styled.form`\n    display: flex;\n`;\n\nconst StyledInput = styled.input`\n    border: 0;\n    border-radius: 6px;\n    display: block;\n    width: 100%;\n    padding: 20px;\n    // font-size: 15px;\n    font-size: 1rem;\n    margin-right: 4px;\n    color: var(--black);\n    background: var(--light-grey);\n`;\n\nconst StyledArea = styled.div`\n    display: grid;\n    // grid-template-columns: 1fr 1fr;\n    padding: 20px;\n    background: var(--app-background);\n    overflow: auto;\n    height: 100vh;\n`;\n\nconst Warning = styled.div`\n    font-size: 13px;\n    color: var(--warning);\n    text-align: center;\n    font-weight: bold;\n    padding-top: 20px;\n`;"]},"metadata":{},"sourceType":"module"}